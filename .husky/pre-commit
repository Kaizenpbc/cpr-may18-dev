#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "🔒 Running pre-commit security checks..."

# Run security audit
echo "📋 Running security audit..."
npm run security:audit

# Check for high/critical vulnerabilities
echo "🚨 Checking for critical vulnerabilities..."
if npm audit --audit-level=high --json | grep -q '"vulnerabilities":{}'; then
  echo "✅ No high/critical vulnerabilities found"
else
  echo "❌ High or critical vulnerabilities detected!"
  echo "Please run 'npm run security:fix' to fix vulnerabilities"
  exit 1
fi

echo "✅ Security checks passed!"