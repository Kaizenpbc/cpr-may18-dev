#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ”’ Running pre-commit security checks..."

# Run security audit
echo "ğŸ“‹ Running security audit..."
npm run security:audit

# Check for high/critical vulnerabilities
echo "ğŸš¨ Checking for critical vulnerabilities..."
if npm audit --audit-level=high --json | grep -q '"vulnerabilities":{}'; then
  echo "âœ… No high/critical vulnerabilities found"
else
  echo "âŒ High or critical vulnerabilities detected!"
  echo "Please run 'npm run security:fix' to fix vulnerabilities"
  exit 1
fi

echo "âœ… Security checks passed!"